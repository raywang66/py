# ChromaCloud 3D HSL 圆柱楔形可视化 - 参考线说明

## 概述

在 3D HSL 可视化中，我们使用**圆柱坐标系**来表示肤色数据，并添加了多条参考线来帮助理解数据分布。

---

## 坐标系统

### 圆柱坐标
```
X 轴: 半径 × cos(色相角度)   ← 饱和度方向
Y 轴: 亮度                   ← 垂直方向 (0-100%)
Z 轴: 半径 × sin(色相角度)   ← 饱和度方向
```

### 映射关系
- **Hue (色相)**: 转换为角度 (0-360°)
- **Saturation (饱和度)**: 转换为半径 (0-1)
- **Lightness (亮度)**: 转换为高度 (0-1)

---

## 参考线系统

### 1. 圆形参考线 (灰色)

#### 底部圆圈 (Y = 0, 暗色区域)
```python
位置: Y = 0.0 (亮度 0%)
半径: 1.0 (最大饱和度)
颜色: 深灰色 [0.3, 0.3, 0.3]
用途: 标记圆柱体底部边界
```

#### 中间圆圈 (Y = 0.5, 中等亮度)
```python
位置: Y = 0.5 (亮度 50%)
半径: 1.0
颜色: 浅灰色 [0.5, 0.5, 0.5]
用途: 中等亮度参考
```

#### 顶部圆圈 (Y = 1.0, 高亮区域)
```python
位置: Y = 1.0 (亮度 100%)
半径: 1.0
颜色: 深灰色 [0.3, 0.3, 0.3]
用途: 标记圆柱体顶部边界
```

---

### 2. 径向参考线 (色相标记)

这些线标记了**肤色的典型色相范围 (15° - 25°)**

#### 🟡 黄色线 #1 - 15° (楔形起点)
```python
角度: 15° (H = 15)
位置: Y = 0.0 (底部)
颜色: 黄色 [0.8, 0.8, 0.2]
用途: 标记肤色色相范围的下限
```
**含义**: 这是最偏红的肤色边界

#### ⚪ 白色/浅灰线 - 20° (楔形中间)
```python
角度: 20° (H = 20)
位置: Y = 0.5 (中间高度)
颜色: 浅灰色 [0.6, 0.6, 0.6]
用途: 标记肤色色相范围的中心
```
**含义**: 典型的肤色主色调

#### 🟡 黄色线 #2 - 25° (楔形终点)
```python
角度: 25° (H = 25)
位置: Y = 1.0 (顶部)
颜色: 黄色 [0.8, 0.8, 0.2]
用途: 标记肤色色相范围的上限
```
**含义**: 这是最偏橙的肤色边界

#### 🔴 红色线 - 0° (色相原点参考)
```python
角度: 0° (H = 0, 纯红色方向)
位置: Y = 0.5 (中间高度)
颜色: 亮红色 [1.0, 0.2, 0.2]
用途: 提供色相的绝对参考 (色轮起点)
```
**含义**: 这是色轮的 0° 参考点，帮助判断肤色偏离红色多远

---

## 视觉布局

### 俯视图 (Top View)
```
        北 (Z+)
         |
    25°  |  0° (红线)
      ＼ | ／
   20°  ＼|／  
         +------- 东 (X+)
   15° ／
      ／
```

### 色相角度对照
```
   0° → 红色 (Red) ----------- 🔴 红色参考线
  15° → 红橙色               🟡 黄色线 #1 (下限)
  20° → 橙红色               ⚪ 白色线 (中心)
  25° → 橙色                 🟡 黄色线 #2 (上限)
  60° → 黄色 (Yellow)
 120° → 绿色 (Green)
 240° → 蓝色 (Blue)
```

---

## 肤色楔形区域

### 定义
```
色相范围: 15° - 25° (10° 的扇形)
饱和度范围: 0 - 1 (从中心到外圈)
亮度范围: 0 - 1 (从底到顶)
```

### 为什么是 15-25°？

基于您在项目开始时的指定：
- **15°**: 最偏红的肤色（深红橙色）
- **20°**: 典型的肤色中心（橙红色）
- **25°**: 最偏黄的肤色（橙色）

这个范围覆盖了大多数人类肤色的色相分布。

---

## 代码实现位置

文件: `CC_Renderer3D.py` (第 140-180 行)

```python
# 底部圆圈 (Y=0)
for i in range(60):
    angle = (i / 60.0) * 2 * np.pi
    axis_pts.append([1.0 * np.cos(angle), 0.0, 1.0 * np.sin(angle)])
    axis_cols.append([0.3, 0.3, 0.3])  # 深灰色

# 黄色线 15° (楔形起点)
for i in range(20):
    t = i / 19.0
    angle = np.radians(15)
    radius = t * 1.0
    axis_pts.append([radius * np.cos(angle), 0.0, radius * np.sin(angle)])
    axis_cols.append([0.8, 0.8, 0.2])  # 黄色

# 白色线 20° (楔形中心)
for i in range(20):
    t = i / 19.0
    angle = np.radians(20)
    radius = t * 1.0
    axis_pts.append([radius * np.cos(angle), 0.5, radius * np.sin(angle)])
    axis_cols.append([0.6, 0.6, 0.6])  # 浅灰色

# 黄色线 25° (楔形终点)
for i in range(20):
    t = i / 19.0
    angle = np.radians(25)
    radius = t * 1.0
    axis_pts.append([radius * np.cos(angle), 1.0, radius * np.sin(angle)])
    axis_cols.append([0.8, 0.8, 0.2])  # 黄色

# 红色线 0° (色相原点)
for i in range(20):
    t = i / 19.0
    angle = 0.0
    radius = t * 1.0
    axis_pts.append([radius * np.cos(angle), 0.5, radius * np.sin(angle)])
    axis_cols.append([1.0, 0.2, 0.2])  # 亮红色
```

---

## 如何阅读这个可视化

### 查看点的位置
1. **水平位置** (XZ 平面): 表示色相 (Hue) 和饱和度 (Saturation)
   - 角度 = 色相
   - 距离中心的距离 = 饱和度

2. **垂直位置** (Y 轴): 表示亮度 (Lightness)
   - 底部 (Y=0): 深色/暗色
   - 中间 (Y=0.5): 中等亮度
   - 顶部 (Y=1): 浅色/亮色

### 参考线的作用
- **黄色线 (15° & 25°)**: 定义肤色的"合法"色相范围
- **红色线 (0°)**: 提供绝对的色相参考点
- **白色/灰色线 (20°)**: 指示典型肤色的中心色相
- **圆圈**: 帮助判断饱和度和亮度层次

---

## 实际应用示例

假设一个点的坐标是：
```
H = 22°, S = 0.6, L = 0.55
```

在 3D 可视化中：
- **角度**: 在 20° (白线) 和 25° (黄线) 之间，靠近白线
- **半径**: 0.6，大约在中心和边缘的 60% 位置
- **高度**: 0.55，略高于中间灰圈

这表示：
- ✅ 色相在正常肤色范围内
- ✅ 中等饱和度
- ✅ 中等亮度

---

## 总结

| 参考线 | 角度 | 高度 | 颜色 | 用途 |
|--------|------|------|------|------|
| 🟡 黄色 #1 | 15° | 0.0 | 黄色 | 楔形起点 (最红) |
| ⚪ 白色 | 20° | 0.5 | 浅灰 | 楔形中心 (典型) |
| 🟡 黄色 #2 | 25° | 1.0 | 黄色 | 楔形终点 (最橙) |
| 🔴 红色 | 0° | 0.5 | 红色 | 色相原点参考 |

**楔形区域 (15°-25°)** 就是肤色集中分布的"合法区域"！

---

**ChromaCloud 项目**  
3D HSL 圆柱楔形可视化系统
